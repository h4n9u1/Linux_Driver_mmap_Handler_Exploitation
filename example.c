#include <stdio.h>
#include <string.h>
#include <fcntl.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <unistd.h>

int main(int argc, char * const * argv) { 
        int fd = open("/dev/H4N9U1", O_RDWR); 
        
        printf("PID: %d\n", getpid());
        if (fd < 0) { 
                printf("[-] Open failed!\n"); 
                return -1; 
        } 
        
        unsigned long * addr = (unsigned long *)mmap((void*)0x42424000, 0x1000, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0x1000); 
        
        if (addr == MAP_FAILED) 
        { 
                perror("Failed to mmap: ");
                close(fd); return -1;
        }
        
        printf("mmap OK addr: %p\n", addr);

        strcpy(addr, "A");
        printf("addr[0]: %c\n", addr[0]);
        printf("Write Strings to %p\n", addr);
        printf("addr[0]: %c\n", addr[0]);

        close(fd);

	getchar();     

        return 0;
        
}

